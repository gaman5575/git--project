pipeline {
    agent any

    environment {
        GIT_CREDENTIALS = credentials('git-credentials')  // Replace with your GitHub credentials ID
        DOCKER_CREDENTIALS = credentials('docker_credentials')  // Replace with your Docker Hub credentials ID
        DOCKER_USERNAME = 'gaman5575'
    }

    stages {
        stage('Git Checkout'){
            steps {
             // Checkout your source code repository
                git branch: 'main',
                    url: 'https://github.com/gaman5575/Jenkins-pipeline-with-ansible.git'
            }
        }

        stage('Clone Repositories and Update Version.yaml') {
            steps {
                script{
                    def repos = ["local1", "local2"]
                    repos.each { repo ->
                        sh """
                            git clone https://${env.GIT_CREDENTIALS_USR}:${env.GIT_CREDENTIALS_PSW}@github.com/${env.GIT_CREDENTIALS_USR}/${repo}.git
                            cd ${repo}

                            // Configuring Git
                            git config user.email "${env.GIT_CREDENTIALS_USR}@gmail.com"
                            git config user.name "${env.GIT_CREDENTIALS_USR}"

                            ls ../
                            rm -rf ${repo}

                        """
                    }
                }
            }
        }
    }
}
